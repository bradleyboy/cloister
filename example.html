<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cloister - Design Preview</title>
  <style>
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-tertiary: #21262d;
      --bg-card: #1c2128;
      --border: #30363d;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --accent: #7c3aed;
      --accent-soft: rgba(124, 58, 237, 0.15);
      --user-accent: #2563eb;
      --user-soft: rgba(37, 99, 235, 0.12);
      --success: #238636;
      --success-soft: rgba(35, 134, 54, 0.15);
      --error: #f85149;
      --error-soft: rgba(248, 81, 73, 0.15);
      --warning: #d29922;
      --code-bg: #0d1117;
      --code-border: #30363d;
      --line-number: #6e7681;
      --diff-add-bg: rgba(46, 160, 67, 0.15);
      --diff-add-border: #238636;
      --diff-remove-bg: rgba(248, 81, 73, 0.1);
      --diff-remove-border: #f85149;
      --radius-sm: 6px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      font-size: 14px;
    }

    /* Layout */
    .app {
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 280px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    .main {
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    .header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
      background: var(--bg-secondary);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .logo {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo-icon {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--accent), #a855f7);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .search-box {
      flex: 1;
      max-width: 400px;
      margin-left: auto;
    }

    .search-input {
      width: 100%;
      padding: 8px 12px 8px 36px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .search-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }

    .search-wrapper {
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      font-size: 14px;
    }

    /* Sidebar Content */
    .sidebar-section {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .sidebar-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .filter-list {
      list-style: none;
    }

    .filter-item {
      padding: 8px 10px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text-secondary);
      transition: all 0.15s;
    }

    .filter-item:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .filter-item.active {
      background: var(--accent-soft);
      color: var(--accent);
    }

    .filter-count {
      margin-left: auto;
      font-size: 12px;
      color: var(--text-muted);
    }

    .filter-radio {
      width: 14px;
      height: 14px;
      border: 2px solid var(--border);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .filter-item.active .filter-radio {
      border-color: var(--accent);
    }

    .filter-item.active .filter-radio::after {
      content: '';
      width: 6px;
      height: 6px;
      background: var(--accent);
      border-radius: 50%;
    }

    /* Tags */
    .tag {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .tag-debugging { background: var(--error-soft); color: #ff7b72; }
    .tag-feature { background: var(--success-soft); color: #7ee787; }
    .tag-refactoring { background: rgba(136, 146, 157, 0.15); color: #8b949e; }
    .tag-git { background: rgba(210, 153, 34, 0.15); color: #d29922; }
    .tag-testing { background: rgba(56, 139, 253, 0.15); color: #58a6ff; }
    .tag-docs { background: rgba(163, 113, 247, 0.15); color: #a371f7; }

    .tag:hover {
      filter: brightness(1.2);
    }

    .tag-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    /* Project List */
    .project-item {
      padding: 8px 10px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text-secondary);
      transition: all 0.15s;
    }

    .project-item:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .project-icon {
      font-size: 14px;
    }

    .project-name {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Session List */
    .session-list {
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .session-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .session-card:hover {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }

    .session-card.active {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent), 0 0 20px var(--accent-soft);
    }

    .session-title {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 6px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .session-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .session-project {
      color: var(--text-secondary);
    }

    .session-dot {
      width: 3px;
      height: 3px;
      background: var(--text-muted);
      border-radius: 50%;
    }

    .session-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 11px;
      color: var(--success);
      font-weight: 500;
    }

    .live-indicator.awaiting {
      color: var(--warning);
    }

    .live-indicator.working {
      color: var(--accent);
    }

    .live-dot {
      width: 6px;
      height: 6px;
      background: var(--success);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .live-indicator.awaiting .live-dot {
      background: var(--warning);
      animation: pulse-urgent 1s infinite;
    }

    .live-indicator.working .live-dot {
      background: var(--accent);
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes pulse-urgent {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.3); }
    }

    /* Awaiting Input Banner */
    .awaiting-banner {
      background: linear-gradient(90deg, rgba(210, 153, 34, 0.15), rgba(210, 153, 34, 0.05));
      border: 1px solid rgba(210, 153, 34, 0.3);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      margin: 16px 24px 0;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: banner-appear 0.3s ease-out;
    }

    @keyframes banner-appear {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .awaiting-banner-icon {
      width: 32px;
      height: 32px;
      background: rgba(210, 153, 34, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
    }

    .awaiting-banner-content {
      flex: 1;
    }

    .awaiting-banner-title {
      font-weight: 600;
      color: var(--warning);
      font-size: 13px;
      margin-bottom: 2px;
    }

    .awaiting-banner-text {
      color: var(--text-secondary);
      font-size: 12px;
    }

    .awaiting-banner-action {
      padding: 8px 14px;
      background: var(--warning);
      color: var(--bg-primary);
      border: none;
      border-radius: var(--radius-sm);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
    }

    .awaiting-banner-action:hover {
      filter: brightness(1.1);
    }

    /* Session card awaiting state */
    .session-card.awaiting {
      border-color: var(--warning);
      box-shadow: 0 0 0 1px var(--warning), 0 0 20px rgba(210, 153, 34, 0.15);
    }

    /* Notification permission banner */
    .notification-prompt {
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      margin: 16px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .notification-prompt-text {
      flex: 1;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .notification-prompt-btn {
      padding: 6px 12px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 12px;
      cursor: pointer;
    }

    .notification-prompt-dismiss {
      padding: 6px 12px;
      background: transparent;
      color: var(--text-muted);
      border: none;
      font-size: 12px;
      cursor: pointer;
    }

    /* Question Card (AskUserQuestion) */
    .question-card {
      background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(124, 58, 237, 0.05));
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: var(--radius-md);
      overflow: hidden;
      margin-top: 12px;
    }

    .question-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: rgba(124, 58, 237, 0.1);
      border-bottom: 1px solid rgba(124, 58, 237, 0.2);
    }

    .question-icon {
      font-size: 14px;
    }

    .question-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--accent);
    }

    .question-body {
      padding: 14px;
    }

    .question-text {
      color: var(--text-primary);
      font-size: 14px;
      margin-bottom: 14px;
      line-height: 1.5;
    }

    .question-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .question-option {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 10px 12px;
      cursor: default;
    }

    .option-label {
      display: block;
      font-weight: 500;
      color: var(--text-primary);
      font-size: 13px;
      margin-bottom: 2px;
    }

    .option-desc {
      display: block;
      color: var(--text-muted);
      font-size: 12px;
    }

    /* Working state indicator */
    .working-indicator {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: var(--accent-soft);
      border: 1px solid rgba(124, 58, 237, 0.2);
      border-radius: var(--radius-md);
      margin: 0 24px 16px;
    }

    .working-spinner {
      width: 16px;
      height: 16px;
      border: 2px solid rgba(124, 58, 237, 0.3);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .working-text {
      color: var(--accent);
      font-size: 13px;
      font-weight: 500;
    }

    /* Session Detail View */
    .detail-view {
      display: none;
      flex-direction: column;
      flex: 1;
    }

    .detail-view.active {
      display: flex;
    }

    .list-view.hidden {
      display: none;
    }

    .detail-header {
      padding: 16px 24px;
      border-bottom: 1px solid var(--border);
      background: var(--bg-secondary);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--text-secondary);
      font-size: 13px;
      cursor: pointer;
      margin-bottom: 12px;
      transition: color 0.15s;
    }

    .back-button:hover {
      color: var(--text-primary);
    }

    .detail-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 6px;
    }

    .detail-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 13px;
      color: var(--text-muted);
    }

    /* Messages */
    .messages {
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      flex: 1;
    }

    .message {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .message-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .message-user .message-label {
      color: var(--user-accent);
    }

    .message-assistant .message-label {
      color: var(--accent);
    }

    .message-content {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 16px;
    }

    .message-user .message-content {
      background: var(--user-soft);
      border-color: rgba(37, 99, 235, 0.2);
    }

    .message-text {
      color: var(--text-primary);
      line-height: 1.7;
    }

    .message-text p {
      margin-bottom: 12px;
    }

    .message-text p:last-child {
      margin-bottom: 0;
    }

    /* Tool Cards */
    .tool-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
      margin-top: 12px;
    }

    .tool-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      cursor: pointer;
    }

    .tool-icon {
      width: 24px;
      height: 24px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    .tool-read .tool-icon { background: rgba(56, 139, 253, 0.15); color: #58a6ff; }
    .tool-edit .tool-icon { background: rgba(210, 153, 34, 0.15); color: #d29922; }
    .tool-bash .tool-icon { background: rgba(139, 148, 158, 0.15); color: #8b949e; }
    .tool-write .tool-icon { background: rgba(46, 160, 67, 0.15); color: #3fb950; }

    .tool-name {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
    }

    .tool-path {
      font-size: 12px;
      color: var(--text-muted);
      font-family: 'SF Mono', 'Fira Code', Consolas, monospace;
    }

    .tool-toggle {
      margin-left: auto;
      color: var(--text-muted);
      font-size: 12px;
      transition: transform 0.2s;
    }

    .tool-card.collapsed .tool-toggle {
      transform: rotate(-90deg);
    }

    .tool-body {
      padding: 0;
    }

    .tool-card.collapsed .tool-body {
      display: none;
    }

    /* Code Blocks */
    .code-block {
      background: var(--code-bg);
      border-radius: 0;
      overflow-x: auto;
      font-family: 'SF Mono', 'Fira Code', Consolas, monospace;
      font-size: 13px;
      line-height: 1.5;
    }

    .code-line {
      display: flex;
      padding: 0 14px;
      min-height: 22px;
    }

    .code-line:hover {
      background: rgba(110, 118, 129, 0.1);
    }

    .line-number {
      color: var(--line-number);
      text-align: right;
      padding-right: 16px;
      user-select: none;
      min-width: 40px;
      flex-shrink: 0;
    }

    .line-content {
      flex: 1;
      white-space: pre;
    }

    /* Diff Styling */
    .diff-add {
      background: var(--diff-add-bg);
    }

    .diff-add .line-number {
      color: var(--diff-add-border);
    }

    .diff-add .line-content {
      color: #7ee787;
    }

    .diff-remove {
      background: var(--diff-remove-bg);
    }

    .diff-remove .line-number {
      color: var(--diff-remove-border);
    }

    .diff-remove .line-content {
      color: #ff7b72;
      text-decoration: line-through;
      text-decoration-color: rgba(255, 123, 114, 0.4);
    }

    /* Syntax Highlighting */
    .token-keyword { color: #ff7b72; }
    .token-string { color: #a5d6ff; }
    .token-function { color: #d2a8ff; }
    .token-comment { color: #8b949e; font-style: italic; }
    .token-variable { color: #ffa657; }
    .token-number { color: #79c0ff; }
    .token-operator { color: #ff7b72; }
    .token-punctuation { color: #8b949e; }
    .token-property { color: #79c0ff; }
    .token-class { color: #ffa657; }

    /* Inline Code */
    code {
      font-family: 'SF Mono', 'Fira Code', Consolas, monospace;
      background: var(--bg-tertiary);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 13px;
    }

    /* Bash Output */
    .bash-output {
      background: var(--code-bg);
      padding: 14px;
      font-family: 'SF Mono', 'Fira Code', Consolas, monospace;
      font-size: 13px;
      color: var(--text-secondary);
      white-space: pre-wrap;
      word-break: break-all;
    }

    .bash-prompt {
      color: var(--success);
    }

    /* Thinking Block */
    .thinking-block {
      background: var(--bg-tertiary);
      border: 1px dashed var(--border);
      border-radius: var(--radius-md);
      padding: 12px 14px;
      margin-top: 12px;
    }

    .thinking-header {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: var(--text-muted);
      font-size: 12px;
    }

    .thinking-icon {
      font-size: 14px;
    }

    .thinking-content {
      display: none;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed var(--border);
      color: var(--text-muted);
      font-style: italic;
      font-size: 13px;
      line-height: 1.6;
    }

    .thinking-block.expanded .thinking-content {
      display: block;
    }

    /* Code Block Header */
    .code-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 14px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border);
    }

    .code-lang {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--text-muted);
      letter-spacing: 0.5px;
    }

    .code-copy {
      padding: 4px 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      font-size: 11px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .code-copy:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    /* Standalone Code Block (in messages) */
    .standalone-code {
      background: var(--code-bg);
      border: 1px solid var(--code-border);
      border-radius: var(--radius-md);
      overflow: hidden;
      margin: 12px 0;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }

    /* Demo Toggle */
    .demo-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      gap: 8px;
      z-index: 100;
    }

    .demo-btn {
      padding: 10px 16px;
      background: var(--accent);
      border: none;
      border-radius: var(--radius-md);
      color: white;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .demo-btn:hover {
      background: #8b5cf6;
    }

    .demo-btn.secondary {
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      color: var(--text-secondary);
    }

    .demo-btn.secondary:hover {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">C</div>
          Cloister
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Time</div>
        <ul class="filter-list">
          <li class="filter-item active">
            <div class="filter-radio"></div>
            All Sessions
            <span class="filter-count">26</span>
          </li>
          <li class="filter-item">
            <div class="filter-radio"></div>
            Today
            <span class="filter-count">4</span>
          </li>
          <li class="filter-item">
            <div class="filter-radio"></div>
            This Week
            <span class="filter-count">12</span>
          </li>
        </ul>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Tags</div>
        <div class="tag-list">
          <span class="tag tag-debugging">debugging (12)</span>
          <span class="tag tag-feature">feature (8)</span>
          <span class="tag tag-refactoring">refactoring (5)</span>
          <span class="tag tag-git">git (5)</span>
          <span class="tag tag-testing">testing (3)</span>
          <span class="tag tag-docs">docs (2)</span>
        </div>
      </div>

      <div class="sidebar-section" style="flex: 1; overflow-y: auto;">
        <div class="sidebar-title">Projects</div>
        <div class="project-item">
          <span class="project-icon">üìÅ</span>
          <span class="project-name">memory-game</span>
          <span class="filter-count">8</span>
        </div>
        <div class="project-item">
          <span class="project-icon">üìÅ</span>
          <span class="project-name">watergun-mmo</span>
          <span class="filter-count">6</span>
        </div>
        <div class="project-item">
          <span class="project-icon">üìÅ</span>
          <span class="project-name">cloister</span>
          <span class="filter-count">5</span>
        </div>
        <div class="project-item">
          <span class="project-icon">üìÅ</span>
          <span class="project-name">bradleyboy.github.io</span>
          <span class="filter-count">4</span>
        </div>
        <div class="project-item">
          <span class="project-icon">üìÅ</span>
          <span class="project-name">api-server</span>
          <span class="filter-count">3</span>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main">
      <!-- List View -->
      <div class="list-view">
        <div class="header">
          <div class="search-box">
            <div class="search-wrapper">
              <span class="search-icon">üîç</span>
              <input type="text" class="search-input" placeholder="Search sessions...">
            </div>
          </div>
        </div>

        <div class="session-list">
          <div class="session-card active awaiting" onclick="showDetail()">
            <div class="session-title">"Fix authentication bug in login flow causing 401 errors for valid credentials"</div>
            <div class="session-meta">
              <span class="session-project">~/code/api-server</span>
              <span class="session-dot"></span>
              <span>2 hours ago</span>
              <span class="session-dot"></span>
              <span class="live-indicator awaiting">
                <span class="live-dot"></span>
                Needs input
              </span>
            </div>
            <div class="session-tags">
              <span class="tag tag-debugging">debugging</span>
              <span class="tag tag-refactoring">refactoring</span>
            </div>
          </div>

          <div class="session-card">
            <div class="session-title">"Add user profile page with avatar upload and bio editing"</div>
            <div class="session-meta">
              <span class="session-project">~/code/myapp</span>
              <span class="session-dot"></span>
              <span>5 min ago</span>
              <span class="session-dot"></span>
              <span class="live-indicator working">
                <span class="live-dot"></span>
                Working...
              </span>
            </div>
            <div class="session-tags">
              <span class="tag tag-feature">feature</span>
            </div>
          </div>

          <div class="session-card">
            <div class="session-title">"Build a memory game with colored stripes and sound effects"</div>
            <div class="session-meta">
              <span class="session-project">~/code/memory-game</span>
              <span class="session-dot"></span>
              <span>3 days ago</span>
            </div>
            <div class="session-tags">
              <span class="tag tag-feature">feature</span>
            </div>
          </div>

          <div class="session-card">
            <div class="session-title">"Refactor database connection pool for better performance"</div>
            <div class="session-meta">
              <span class="session-project">~/code/api-server</span>
              <span class="session-dot"></span>
              <span>4 days ago</span>
            </div>
            <div class="session-tags">
              <span class="tag tag-refactoring">refactoring</span>
            </div>
          </div>

          <div class="session-card">
            <div class="session-title">"Set up CI/CD pipeline with GitHub Actions"</div>
            <div class="session-meta">
              <span class="session-project">~/code/myapp</span>
              <span class="session-dot"></span>
              <span>1 week ago</span>
            </div>
            <div class="session-tags">
              <span class="tag tag-git">git</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Detail View -->
      <div class="detail-view" id="detail-view">
        <div class="detail-header">
          <div class="back-button" onclick="showList()">
            ‚Üê Back to sessions
          </div>
          <div class="detail-title">"Fix authentication bug in login flow"</div>
          <div class="detail-meta">
            <span>~/code/api-server</span>
            <span>‚Ä¢</span>
            <span>Jan 24, 2026</span>
            <span>‚Ä¢</span>
            <span>45 messages</span>
            <span>‚Ä¢</span>
            <span class="live-indicator awaiting">
              <span class="live-dot"></span>
              Awaiting your input
            </span>
          </div>
        </div>

        <!-- Awaiting Input Banner -->
        <div class="awaiting-banner">
          <div class="awaiting-banner-icon">‚úã</div>
          <div class="awaiting-banner-content">
            <div class="awaiting-banner-title">Claude is waiting for your response</div>
            <div class="awaiting-banner-text">Return to your terminal to continue the conversation</div>
          </div>
          <button class="awaiting-banner-action" onclick="copyTerminalCommand()">Copy: cd ~/code/api-server</button>
        </div>

        <div class="messages">
          <!-- User Message -->
          <div class="message message-user">
            <div class="message-label">You</div>
            <div class="message-content">
              <div class="message-text">
                The login is failing with a 401 error even with valid credentials. Can you help debug this?
              </div>
            </div>
          </div>

          <!-- Assistant Message with Tool Use -->
          <div class="message message-assistant">
            <div class="message-label">Claude</div>
            <div class="message-content">
              <div class="message-text">
                <p>I'll investigate the authentication flow. Let me start by looking at the login handler to understand how credentials are being validated.</p>
              </div>

              <!-- Read Tool -->
              <div class="tool-card tool-read">
                <div class="tool-header">
                  <div class="tool-icon">üìÑ</div>
                  <span class="tool-name">Read</span>
                  <span class="tool-path">src/auth/login.ts</span>
                  <span class="tool-toggle">‚ñº</span>
                </div>
                <div class="tool-body">
                  <div class="code-block">
                    <div class="code-line">
                      <span class="line-number">1</span>
                      <span class="line-content"><span class="token-keyword">import</span> { verify } <span class="token-keyword">from</span> <span class="token-string">'./jwt'</span>;</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">2</span>
                      <span class="line-content"><span class="token-keyword">import</span> { db } <span class="token-keyword">from</span> <span class="token-string">'../db'</span>;</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">3</span>
                      <span class="line-content"></span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">4</span>
                      <span class="line-content"><span class="token-keyword">export async function</span> <span class="token-function">login</span>(req, res) {</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">5</span>
                      <span class="line-content">  <span class="token-keyword">const</span> { email, password } = req.body;</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">6</span>
                      <span class="line-content">  <span class="token-keyword">const</span> user = <span class="token-keyword">await</span> db.users.<span class="token-function">findByEmail</span>(email);</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">7</span>
                      <span class="line-content">  </span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">8</span>
                      <span class="line-content">  <span class="token-keyword">const</span> secret = process.env.SECRET;</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">9</span>
                      <span class="line-content">  <span class="token-keyword">const</span> token = <span class="token-function">sign</span>({ userId: user.id }, secret);</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">10</span>
                      <span class="line-content">  </span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">11</span>
                      <span class="line-content">  <span class="token-keyword">return</span> res.<span class="token-function">json</span>({ token });</span>
                    </div>
                    <div class="code-line">
                      <span class="line-number">12</span>
                      <span class="line-content">}</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="message-text" style="margin-top: 16px;">
                <p>I found the issue. On line 8, the code is using <code>process.env.SECRET</code> but looking at your <code>.env.example</code> file, the variable should be <code>JWT_SECRET</code>. This means the secret is <code>undefined</code>, which causes the JWT signing to fail.</p>
              </div>
            </div>
          </div>

          <!-- Assistant Message with Edit -->
          <div class="message message-assistant">
            <div class="message-label">Claude</div>
            <div class="message-content">
              <div class="message-text">
                <p>Let me fix this by updating the environment variable name:</p>
              </div>

              <!-- Edit Tool with Diff -->
              <div class="tool-card tool-edit">
                <div class="tool-header">
                  <div class="tool-icon">‚úèÔ∏è</div>
                  <span class="tool-name">Edit</span>
                  <span class="tool-path">src/auth/login.ts</span>
                  <span class="tool-toggle">‚ñº</span>
                </div>
                <div class="tool-body">
                  <div class="code-block">
                    <div class="code-line diff-remove">
                      <span class="line-number">8</span>
                      <span class="line-content">  <span class="token-keyword">const</span> secret = process.env.SECRET;</span>
                    </div>
                    <div class="code-line diff-add">
                      <span class="line-number">8</span>
                      <span class="line-content">  <span class="token-keyword">const</span> secret = process.env.JWT_SECRET;</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Assistant Message with Bash -->
          <div class="message message-assistant">
            <div class="message-label">Claude</div>
            <div class="message-content">
              <div class="message-text">
                <p>Now let me verify the fix by running the tests:</p>
              </div>

              <!-- Bash Tool -->
              <div class="tool-card tool-bash">
                <div class="tool-header">
                  <div class="tool-icon">$</div>
                  <span class="tool-name">Bash</span>
                  <span class="tool-path">npm test -- --grep "auth"</span>
                  <span class="tool-toggle">‚ñº</span>
                </div>
                <div class="tool-body">
                  <div class="bash-output"><span class="bash-prompt">$</span> npm test -- --grep "auth"

  auth
    login
      ‚úì should return 200 for valid credentials (45ms)
      ‚úì should return 401 for invalid password (12ms)
      ‚úì should return 404 for unknown user (8ms)

  3 passing (65ms)</div>
                </div>
              </div>

              <div class="message-text" style="margin-top: 16px;">
                <p>All tests are passing now. The issue was simply a mismatch between the environment variable name in the code (<code>SECRET</code>) and the actual variable name in your environment (<code>JWT_SECRET</code>).</p>
              </div>

              <!-- Thinking Block -->
              <div class="thinking-block" onclick="this.classList.toggle('expanded')">
                <div class="thinking-header">
                  <span class="thinking-icon">üí≠</span>
                  <span>View thinking</span>
                </div>
                <div class="thinking-content">
                  I should also check if there are any other places in the codebase that use the old SECRET variable name. Let me search for it... Actually, looking at the test results, everything is passing now, so the change I made was the only place this was used incorrectly.
                </div>
              </div>
            </div>
          </div>

          <!-- User Follow-up -->
          <div class="message message-user">
            <div class="message-label">You</div>
            <div class="message-content">
              <div class="message-text">
                That fixed it, thanks! Can you also add some error handling if JWT_SECRET is not defined?
              </div>
            </div>
          </div>

          <!-- Assistant with Code Block -->
          <div class="message message-assistant">
            <div class="message-label">Claude</div>
            <div class="message-content">
              <div class="message-text">
                <p>Good idea. Let me add a startup check that will fail fast if the required environment variables are missing:</p>
              </div>

              <div class="standalone-code">
                <div class="code-header">
                  <span class="code-lang">TypeScript</span>
                  <button class="code-copy">Copy</button>
                </div>
                <div class="code-block">
                  <div class="code-line">
                    <span class="line-number">1</span>
                    <span class="line-content"><span class="token-comment">// src/config/env.ts</span></span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">2</span>
                    <span class="line-content"><span class="token-keyword">const</span> requiredEnvVars = [</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">3</span>
                    <span class="line-content">  <span class="token-string">'JWT_SECRET'</span>,</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">4</span>
                    <span class="line-content">  <span class="token-string">'DATABASE_URL'</span>,</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">5</span>
                    <span class="line-content">] <span class="token-keyword">as const</span>;</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">6</span>
                    <span class="line-content"></span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">7</span>
                    <span class="line-content"><span class="token-keyword">export function</span> <span class="token-function">validateEnv</span>() {</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">8</span>
                    <span class="line-content">  <span class="token-keyword">const</span> missing = requiredEnvVars.<span class="token-function">filter</span>(</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">9</span>
                    <span class="line-content">    (key) => !process.env[key]</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">10</span>
                    <span class="line-content">  );</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">11</span>
                    <span class="line-content">  </span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">12</span>
                    <span class="line-content">  <span class="token-keyword">if</span> (missing.length > <span class="token-number">0</span>) {</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">13</span>
                    <span class="line-content">    <span class="token-keyword">throw new</span> <span class="token-class">Error</span>(</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">14</span>
                    <span class="line-content">      <span class="token-string">`Missing env vars: ${missing.join(', ')}`</span></span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">15</span>
                    <span class="line-content">    );</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">16</span>
                    <span class="line-content">  }</span>
                  </div>
                  <div class="code-line">
                    <span class="line-number">17</span>
                    <span class="line-content">}</span>
                  </div>
                </div>
              </div>

              <div class="message-text" style="margin-top: 12px;">
                <p>I'll create this file and call <code>validateEnv()</code> at the start of your server initialization. This way you'll get a clear error message immediately on startup if any required environment variables are missing.</p>
              </div>
            </div>
          </div>

          <!-- Claude asking a question -->
          <div class="message message-assistant">
            <div class="message-label">Claude</div>
            <div class="message-content">
              <div class="message-text">
                <p>I have a question before proceeding:</p>
              </div>

              <!-- Question Card -->
              <div class="question-card">
                <div class="question-header">
                  <span class="question-icon">‚ùì</span>
                  <span class="question-title">Claude is asking</span>
                </div>
                <div class="question-body">
                  <p class="question-text">Should I also add validation for optional environment variables with sensible defaults, or only validate the strictly required ones?</p>
                  <div class="question-options">
                    <div class="question-option">
                      <span class="option-label">Required only</span>
                      <span class="option-desc">Only fail on missing required vars</span>
                    </div>
                    <div class="question-option">
                      <span class="option-label">Warn on optional</span>
                      <span class="option-desc">Log warnings for missing optional vars</span>
                    </div>
                    <div class="question-option">
                      <span class="option-label">Full validation</span>
                      <span class="option-desc">Validate types and formats too</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- Demo Controls -->
  <div class="demo-toggle">
    <button class="demo-btn secondary" onclick="showList()">List View</button>
    <button class="demo-btn" onclick="showDetail()">Detail View</button>
    <button class="demo-btn secondary" onclick="requestNotificationPermission()">Enable Notifications</button>
  </div>

  <script>
    function showDetail() {
      document.querySelector('.list-view').classList.add('hidden');
      document.querySelector('.detail-view').classList.add('active');
    }

    function showList() {
      document.querySelector('.list-view').classList.remove('hidden');
      document.querySelector('.detail-view').classList.remove('active');
    }

    // Toggle tool cards
    document.querySelectorAll('.tool-header').forEach(header => {
      header.addEventListener('click', (e) => {
        e.stopPropagation();
        header.parentElement.classList.toggle('collapsed');
      });
    });

    // Copy terminal command
    function copyTerminalCommand() {
      navigator.clipboard.writeText('cd ~/code/api-server && claude --continue');
      const btn = event.target;
      const original = btn.textContent;
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = original, 2000);
    }

    // Browser Notification System
    // In the real implementation, this would be triggered by SSE events

    async function requestNotificationPermission() {
      if ('Notification' in window) {
        const permission = await Notification.requestPermission();
        if (permission === 'granted') {
          console.log('Notifications enabled');
        }
      }
    }

    function showAwaitingNotification(sessionTitle, projectPath) {
      if (Notification.permission === 'granted') {
        const notification = new Notification('Claude needs your input', {
          body: sessionTitle,
          icon: 'ü§ñ',
          tag: 'claude-awaiting', // Prevents duplicate notifications
          requireInteraction: true // Stays until dismissed
        });

        notification.onclick = () => {
          window.focus();
          showDetail();
          notification.close();
        };
      }
    }

    // Demo: Show notification after 3 seconds (simulating SSE event)
    // In real implementation, this fires when session state changes to "awaiting"
    setTimeout(() => {
      if (Notification.permission === 'default') {
        // Could show a prompt to enable notifications
        console.log('Consider enabling notifications for awaiting alerts');
      }
    }, 3000);

    // Real-time status detection logic (pseudo-code for proposal)
    //
    // function determineSessionStatus(messages) {
    //   const lastMsg = messages[messages.length - 1];
    //
    //   if (lastMsg.type !== 'assistant') return 'awaiting'; // User's turn
    //
    //   const content = lastMsg.message.content;
    //   const hasToolUse = content.some(c => c.type === 'tool_use');
    //   const hasQuestion = content.some(c =>
    //     c.type === 'tool_use' && c.name === 'AskUserQuestion'
    //   );
    //
    //   if (hasQuestion) return 'awaiting';      // Explicit question
    //   if (hasToolUse) return 'working';        // Tool in progress
    //   return 'awaiting';                       // Finished, waiting for user
    // }
  </script>
</body>
</html>
